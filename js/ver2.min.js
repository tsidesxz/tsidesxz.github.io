function i18n(a){var b=$("*[data-lang]");$.getJSON("/locales/"+a+"/translation.json",function(a){for(var c=0;c<b.length;c++){var d=$(b[c]).data().lang,e=Object.byString(a,d);$(b[c]).is("input")||$(b[c]).is("textarea")?$(b[c])[0].placeholder=e:$(b[c]).html(e)}}),$(".coupon-instruction").attr("src","/img/ver3/shuttle/coupon-instruction-"+a+"@2x.png")}function load_faq(a){if(0!=$("#faq").length){console.log("load_faq"),$("#faq").foundation("destroy"),$("#faq").empty();for(var b=0;b<a.length;b++){var c=a[b];$("#faq").append("<li class='accordion-item'><a href='#panel"+b+"d' role='tab' class='accordion-title' id='panel"+b+"d-heading' aria-controls='panel"+b+"d'>"+c.q+"</a><div id='panel"+b+"d' class='accordion-content' role='tabpanel' data-tab-content aria-labelledby='panel"+b+"d-heading'>"+c.a+"</div></li>")}$("#faq").foundation()}}function i18n_faq(a,b){var c=$(".container").data("title");"support"==c&&(c=b?b:$(".support-cat-wrap a.active").data("cat")),$.getJSON("/locales/"+a+"/faq_"+c+".json",function(a){if(console.log(a),$.isArray(a))faq=a,$("#faq-cat-sel").hide(),load_faq(faq);else{faq={},$.each(a,function(a,b){return"category_names"===a?($("#faq-cat-sel").show().empty(),void $.each(b,function(a,b){$("#faq-cat-sel").append($("<option>",{value:a,text:b}))})):void(faq[a]=b)});var b=window.faq_category||Object.keys(faq)[0];$.each($("#faq-cat-sel option"),function(){$(this).val()==b&&$(this).attr("selected",!0)}),load_faq(faq[b]),$("#faq-cat-sel").unbind(),$("#faq-cat-sel").change(function(){load_faq(faq[$(this).val()])})}})}function load_font(a){var b="",c=["Light","Regular"],d=document.createElement("style");if(d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),"en"!==a)for(var e=0;e<c.length;e++)b+="@font-face {font-family: 'Noto"+c[e]+"-"+a+"'; font-style: normal; font-weight: normal; src: url('../fonts/subset/Noto"+c[e]+"-"+a+".otf') format('truetype');} ";d.innerText=b,b&&$("head")[0].appendChild(d)}function change_lang(a){console.log("change_lang="+a),lsTest()===!0&&(console.log("setup localstorage locale"),window.localStorage.locale=a),load_font(a),i18n(a);var b=$(".container").data("title");switch(b){case"customer":case"chauffeur":i18n_fare(a,"sz_hk");case"shuttle":case"support":i18n_faq(a),displayDlBtn(getMobileOS(),a,countryCode,$(".banner-download"));break;case"bopo":i18n_fare(a,"sz_hk");break;case"corp":i18n_faq(a),displayDlBtn(getMobileOS(),a,countryCode,$(".banner-download")),$(".corp_signin").attr("href","http://corp.easi-way.com?lang="+a),$("#corpForm select").val(a),$("#submitCorp").on("click",function(a){if(a.preventDefault(),checkForm($("#corpForm"))){var b={prefLang:$("#corpForm select").val()};$("#corpForm input").each(function(){b[$(this).attr("name")]=$(this).val()}),$.post("http://submit.easi-way.com/submit/corp",b).then(showSuccessMsg,function(a){console.log(a)})}})}$(".tabs-title").removeClass("is-active"),$("#tab-crossborder").parent().addClass("is-active"),$("#policy").attr("href","http://policy.easi-way.com/"+a+".html")}function i18n_fare(a,b){$.getJSON("/locales/"+a+"/"+b+"_faretable.json",function(c){var d="",e=c.buttons;$(".region-tab").eq(0).text(e[0]),$(".region-tab").eq(1).text(e[1]),$(".region-tab").eq(2).text(e[2]),$(".region-tab").eq(3).text(e[3]);var f=[],g=[],h=[];$.each(c,function(a,b){switch(a.charAt(0)){case"h":f.push(b);break;case"a":g.push("<tr><td>"+b[0]+"</td><td>"+b[1]+"</td></tr>");break;case"n":h.push("<p>"+b+"</p>");break;case"r":d="<tr><td>"+b[0]+"</td><td>"+b[1]+"</td></tr>"}}),$("#fare-title").empty().html("<b>"+f[0]+"</b><br><span class='smalltext'>"+f[1]+"</span><br><button id='a_fee_button' onclick='toFareAddTable(false);'><img src='img/btn-noti@2x.png' class='btn_noti'> "+f[2]+"</button><br><span class='guide'>"+f[3]+"</span>"),$("#fare-add-table").empty().append(g),$("#easiway-support").empty().append(h),$.getJSON("http://dev.easi-way.com/districts/"+b+"/"+a,function(a){$("#fare-data").empty(),$.each(a.districts,function(c,e){var f="";$.each(a.districts,function(c,d){var g=e.id+"_"+d.id;!a.prices[g]||""==a.prices[g].currency||"sz_gd"==b&&e.id==d.id||(f+="<tr class='price_table'><td id='district_name'>"+d.name+"</td><td id='price'>"+a.prices[g].price+"</td></tr>")}),""!=f&&("sz_gd"==b?$("#fare-data").append('<div><table class="table no-accordion">'+d+f):($("#fare-data").append('<h3 class="district">'+e.name),$("#fare-data").append('<div><table class="table">'+f)))}),"sz_gd"!=b&&($("#fare-data").accordion("instance")?($("#fare-data").accordion("option","active",!1),$("#fare-data").accordion("refresh")):$("#fare-data").accordion({collapsible:!0,heightStyle:"content",active:!1}))})})}function toFareAddTable(a){var b=location.href.indexOf("fare")>-1?$("body").overflowAndroid():$("#faretable").overflowAndroid();b.animate({scrollTop:a?0:$("#fare-add-table").position().top})}function getMobileOS(){var a=navigator.userAgent||navigator.vendor||window.opera;return a.match(/iPad/i)||a.match(/iPhone/i)||a.match(/iPod/i)?"iOS":a.match(/Android/i)?"Android":"unknown"}function displayDlBtn(a,b,c,d){function e(a,b){var d="",e=document.createElement("a");return"CN"==c&&"Android"==a&&(d="_cn"),$(e).text(f[a+d][b]).attr("href",f[a+d].href),e}if(a.length<1)throw new Error("Missing platform");d.length<1,b=b||"en",c=c||"CN";var f={iOS:{en:"Appstore","zh-cn":"苹果商店","zh-hk":"蘋果商店",ko:"앱 스토어",ja:"アップストア",href:"https://itunes.apple.com/us/app/easiway/id993087185"},Android:{en:"Google Play","zh-cn":"安卓商店","zh-hk":"安卓商店",ko:"구글 플레이",ja:"グーグル プレイ",href:"https://play.google.com/store/apps/details?id=com.easi6.easiway.android"},Android_cn:{en:"Android Market","zh-cn":"安卓市场","zh-hk":"安卓市場",ko:"안드로이드 마켓",ja:"Android マーケット",href:"/android_download.html"}};switch(a){case"unknown":d.empty().append(e("iOS",b),e("Android",b));break;case"Android":case"iOS":d.empty().append(e(a,b));break;default:console.log("Cant recognize platform")}}function areWeInChina(a){var b;b="CN"===a?"http://player.youku.com/embed/XMTM0MTU5NzkxMg==?autoPlay=0":"https://www.youtube.com/embed/sjygTUFjJJ4?rel=0&modestbranding=1&controls=0&autoplay=0&showinfo=0",$(".video-container").html("<iframe width='560' height='315' src='"+b+"' frameborder='0' allowfullscreen></iframe>")}function toTitleCase(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}function loadBannerVideo(a){a.append('<video autoplay loop><source src="/img/vid/vid2.webm" type="video/webm"><source src="/img/vid/vid2.mp4" type="video/mp4"></video>')}function checkForm(a){var b;return $("#corpForm input").each(function(a){""==$(this).val()?($(this).addClass("errorinput"),$(this).siblings(".errormsg").text("This must be filled"),b=!0):($(this).removeClass("errorinput"),$(this).siblings(".errormsg").text(""),b=!1)}),!b}function showSuccessMsg(){$("#corpForm").addClass("downandaway"),$("#success").addClass("upandappear")}function search(a){$.when(_google_search(a),_baidu_search(a)).then(function(a){return arguments[0].concat(arguments[1])}).then(function(a){a=a.filter(function(a){return"香港"==a.city.slice(0,2)||"深圳"==a.city.slice(0,2)});var b=[];0==a.length&&b.push(fare_msgs[lang].noresult);for(var c=0;c<a.length;c++)b.push("<div class='res' data-lat="+a[c].point.lat+" data-lng="+a[c].point.lng+"><p class='title'>"+toTitleCase(a[c].title)+"</p><p class='address'>"+a[c].address+"</p></div>");$(".result").empty().append(b),selectLocation()})}function _google_search(a){return $.getJSON("http://dev.easi-way.com/location_infos/search_na",{q:a,webapp:!0}).then(function(a){return a.map(function(a){return a.point=new BMap.Point(a.longitude,a.latitude),a.title=a.name,a})})}function _baidu_search(a){var b=$.Deferred(),c=$.Deferred();return bd_searcher_hk.setSearchCompleteCallback(function(a){b.resolve(a)}),bd_searcher_hk.search(a),bd_searcher_sz.setSearchCompleteCallback(function(a){c.resolve(a)}),bd_searcher_sz.search(a),$.when(b,c).then(function(a,b){for(var c=[],d=0;d<a.getCurrentNumPois();d++)c.push(a.getPoi(d));for(var d=0;d<b.getCurrentNumPois();d++)c.push(b.getPoi(d));return c})}function selectLocation(){$(".res").click(function(){var a=$(this);a.parent().siblings("#pic").length?convertCoord(a.data("lat"),a.data("lng")).then(function(a){selected.from_longitude=a.lng,selected.from_latitude=a.lat}):convertCoord(a.data("lat"),a.data("lng")).then(function(a){selected.to_longitude=a.lng,selected.to_latitude=a.lat});var b=a.parent().siblings("input"),c=a.parent().siblings(".close");b.val($(".title",this).text()),b.removeClass("error").addClass("selected"),c.removeClass("displaynone")})}function convertCoord(a,b){var c=$.Deferred(),d=[new BMap.Point(b,a)];return(new BMap.Convertor).translate(d,3,5,function(a){0===a.status&&c.resolve(a.points[0])}),c}function submitTripInfo(){var a={time:"#tim",from_latitude:"#pic",from_longitude:"#pic",to_latitude:"#des",to_longitude:"#des"},b=!1;for(var c in a)selected[c]||(b=!0,$(a[c]).addClass("error"));b||$.post("http://dev.easi-way.com/payments/estimate_na",selected).then(function(a){for(var b in selected)delete selected[b];var c={};for(var d in a.fare){var e=a.fare[d];if(e.original){c.amount=e.amount,c.currency=d;break}}$(".fare-price").removeClass("displaynone"),$("#price").html("<h3>"+fare_msgs[lang].pricemsg+"</h3><h2>"+c.amount+"<sup>.00</sup> "+c.currency+"</h2>")}).fail(function(){$(".fare-price").removeClass("displaynone"),$("#price").html("<h3>"+fare_msgs[lang].errmsg+"</h3>")})}function getQuotation(){}function lsTest(){var a="test";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}}function check_if_in_view(a){var b=$window.height(),c=$window.scrollTop(),d=c+b;$.each(a,function(){var a=$(this),b=a.outerHeight(),e=a.offset().top,f=e+b;f>=c&&e<=d?a.addClass("in-view"):a.removeClass("in-view")})}function indicator(a,b,c){$.each(a,function(a,c){$(this).on("click",function(){window.clearInterval(e),$(this).addClass("id-is-active"),$(this).siblings().removeClass("id-is-active"),b.goToPage(a,0,400)})}),b.on("scrollEnd",function(){var b=$(a[this.currentPage.pageX]);b.addClass("id-is-active"),b.siblings().removeClass("id-is-active")});var d=1,e=setInterval(function(){b.goToPage(d,0,400),d=d==c-1?0:d+1},2e3)}function toggleMenu(){$("#menu-mobile").toggleClass("js-is-open"),$("#menu").children("li").toggleClass("slideUpAnimate"),$("#menu").toggleClass("show-for-medium"),$("body").toggleClass("overflow-hidden")}Object.byString=function(a,b){b=b.replace(/\[(\w+)\]/g,".$1"),b=b.replace(/^\./,"");for(var c=b.split("."),d=0,e=c.length;d<e;++d){var f=c[d];if(!(f in a))return;a=a[f]}return a};var faq=null;$(window).scroll(function(){var a=120,b=$(this).scrollTop()+a;b<610?($(".topbar.colored").removeClass("hide"),$(".topbar.white").addClass("hide")):($(".topbar.colored").addClass("hide"),$(".topbar.white").removeClass("hide"))}),$(function(){var a=$(".container").data("title");$(".topbar.white .close-button-big").addClass(a)});var lang,current_page=$(".container").data("title"),$window=$(window),default_lang="en",fulllang=window.navigator.userLanguage||window.navigator.language;try{if(null===window.localStorage||void 0===window.localStorage.locale||null===window.localStorage.locale)switch(fulllang){case"zh-hk":case"zh-hant":lang="zh-hk";break;case"zh-tw":case"zh-cn":case"zh-hans":lang="zh-cn";break;default:var shortlang=fulllang.split("-");lang=shortlang[0]}else lang=window.localStorage.locale}catch(err){lang=default_lang}console.log("lang="+lang),$.each(document.location.search.substr(1).split("&"),function(a,b){var c=b.split("=");"lang"==c[0]?lang=c[1]:"locale"==c[0]&&(lang="zh_hant"==c[1]?"zh-hk":"zh_hans"==c[1]?"zh-cn":c[1])});var countryCode=geoplugin_countryCode(),selected={},thread=null;$(document).ready(function(){$(document).foundation(),change_lang(lang),$(".service-area").addClass(lang),"customer"==current_page&&$(window).width()>743&&loadBannerVideo($(".banner")),$(".region-tab").click(function(a){var b=$(this).attr("id");return $(".tabs-title").removeClass("is-active"),$("#"+b).parent().addClass("is-active"),"tab-crossborder"==b?i18n_fare(lang,"sz_hk"):"tab-hk-local"==b?i18n_fare(lang,"hk_local"):"tab-sz-local"==b?i18n_fare(lang,"sz_local"):i18n_fare(lang,"sz_gd"),a.preventDefault(),!1}),$(".i18n").click(function(){lang=$(this).attr("href").substring(1),change_lang(lang),$(".dropdownmenu").addClass("displaynone")}),areWeInChina(countryCode),$("#lang-select").click(function(){$(".dropdownmenu").toggleClass("displaynone")}),$(document).click(function(a){$(a.target).is(".dropdownmenu, #lang-select")||$(".dropdownmenu").addClass("displaynone")}),$("#menu-mobile").click(toggleMenu),$("#lang-select-mobile").click(toggleMenu);var a=new Date,b=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);try{$("#tim").fdatepicker({format:"yyyy-mm-dd hh:ii",disableDblClickSelection:!0,pickTime:!0,onRender:function(a){return a.valueOf()<b.valueOf()?"disabled":""}}).on("changeDate",function(){$(this).removeClass("error").addClass("selected"),$(this).siblings(".close").removeClass("displaynone");var a=$(this).val(),b=new Date(a);selected.time=b.toISOString(),console.log(selected.time)})}catch(c){}$("#farecalc").length>0&&($(document).keypress(function(a){13==a.which&&(a.preventDefault(),submitTripInfo())}),$("#pic").focus(function(){$(this).siblings(".result").empty().append(fare_msgs[lang].instruction).removeClass("displaynone"),$("#des").siblings(".result").addClass("displaynone")}),$("#des").focus(function(){$(this).siblings(".result").empty().append(fare_msgs[lang].instruction).removeClass("displaynone"),$("#pic").siblings(".result").addClass("displaynone")}),$("#pic, #des").keyup(function(){var a=$(this).val(),b=$(this).siblings(".result");a?(clearTimeout(thread),b.empty().append(fare_msgs[lang].searching),thread=setTimeout(function(){b.removeClass("displaynone"),search(a)},1e3)):(clearTimeout(thread),$(".result").empty().append(fare_msgs[lang].instruction))}),$(document).click(function(a){$(a.target).is("#pic, #des")||$(".result").addClass("displaynone")}),$(".close").click(function(a){a.preventDefault(),$(this).addClass("displaynone"),$(this).siblings("input").removeClass("selected").val(""),$(this).siblings("#pic").length?(delete selected.from_latitude,delete selected.to_longtitude):$(this).siblings("#des").length?(delete selected.to_latitude,delete selected.to_longtitude,console.log(selected)):delete selected.time}),$(".tryanother").click(function(a){a.preventDefault(),$(this).parents(".fare-price").addClass("displaynone"),$("form").find("input").removeClass("selected").val(""),$(".close").addClass("displaynone")}),$("#send").click(function(){submitTripInfo()}));var d,e;if("customer"==current_page){d=new IScroll("#carousel1",{eventPassthrough:!0,scrollX:!0,scrollY:!1,momentum:!1,snap:"li",snapSpeed:400,preventDefault:!1}),e=new IScroll("#carousel2",{eventPassthrough:!0,scrollX:!0,scrollY:!1,momentum:!1,snap:"li",snapSpeed:400,preventDefault:!1});var f=$("#indicator1").children(".dot"),g=$("#indicator2").children(".dot");indicator(f,d,f.length),indicator(g,e,g.length)}if($(".corp-aboutus").length>0){var h=new IScroll("#wrapper",{eventPassthrough:!0,scrollX:!0,scrollY:!1,momentum:!1,snap:".column",snapSpeed:400,preventDefault:!1,indicators:{el:document.getElementById("indicator"),resize:!1}});$("#prevPage").css("visibility","hidden"),h.on("scrollEnd",function(){$("#prevPage").css("visibility",0==h.currentPage.pageX?"hidden":"visible"),$("#nextPage").css("visibility",5==h.currentPage.pageX?"hidden":"visible")}),$("#nextPage").on("click",function(){h.next()}),$("#prevPage").on("click",function(){h.prev()})}if($(".service-map").length>0){var i,j,k;i=function(a,b){var c=10,d=10,e=this.getSizes(),f=-((e.viewBox.x+e.viewBox.width)*e.realZoom)+c,g=e.width-c-e.viewBox.x*e.realZoom,h=-((e.viewBox.y+e.viewBox.height)*e.realZoom)+d,i=e.height-d-e.viewBox.y*e.realZoom,j={};return j.x=Math.max(f,Math.min(g,b.x)),j.y=Math.max(h,Math.min(i,b.y)),j},j=document.querySelector("#map"),k=svgPanZoom(j,{controlIconsEnabled:!1,minZoom:1,maxZoom:10,fit:!0,mouseWheelZoomEnabled:!1,beforePan:i});var l=$(".busline__legend").children("li");$.each(l,function(a,b){$(this).hover(function(){$(".line-busline").css("opacity",.1),$(".line"+a).css("opacity",1)},function(){$(".line-busline").css("opacity",1)})}),$(".controller__zoomin").click(function(a){a.preventDefault(),k.zoomIn()}),$(".controller__zoomout").click(function(a){a.preventDefault(),k.zoomOut()})}});var fadeInCSS={opacity:0},slideUpCSS={opacity:0,transform:"translateY(100px)","-webkit-transform":"translateY(100px)","-moz-transform":"translateY(100px)"};$(".fade-in").css(fadeInCSS),$(".slide-up").css(slideUpCSS);var $animation_elements=$(".animate"),$has_carousel=$(".has-carousel");"customer"!=current_page&&"chauffeur"!=current_page&&"shuttle"!=current_page||($window.on("scroll resize",function(){check_if_in_view($animation_elements),check_if_in_view($has_carousel)}),$window.trigger("scroll"));var fare_msgs={en:{instruction:"Start typing to search",searching:"Searching...",noresult:"No results found",pricemsg:"Your trip costs",errmsg:"Unfortunately, this trip is not available."},ko:{instruction:"검색어를 입력해주세요",searching:"검색중...",noresult:"검색 결과가 없습니다",pricemsg:"이용시 예상 요금",errmsg:"죄송합니다만 서비스 지역이 아닙니다."},"zh-cn":{instruction:"输入地址进行搜索",searching:"搜索中...",noresult:"未找到结果",pricemsg:"您的行程费用是",errmsg:"对不起，我们无法为该行程提供服务。"},"zh-hk":{instruction:"輸入位址進行搜索",searching:"搜索中...",noresult:"未找到結果",pricemsg:"您的行程費用是",errmsg:"  對不起，我們無法為該行程提供服務。"}},loaded_font={},bd_searcher_hk,bd_searcher_sz;try{bd_searcher_hk=new BMap.LocalSearch("香港特别行政区",{}),bd_searcher_sz=new BMap.LocalSearch("深圳市",{})}catch(err){console.error("baidu not be working yo!")}var imgShuffler=setInterval(function(){var a=$(".img-shuffle").first();a.css("opacity","0"),setTimeout(function(){$(".phoneimg").append(a),a.css("opacity",".99")},400);var b="."+a.attr("data-for");$(b).addClass("li-is-active"),$(b).siblings("li").removeClass("li-is-active")},2e3);